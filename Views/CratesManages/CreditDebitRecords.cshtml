@model IEnumerable<Milk_Bakery.Models.CreditDebitRecord>

@{
    ViewData["Title"] = "Credit & Debit Records";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    .card-header-custom {
        background-color: #28a745;
        /* Green color for debit/credit */
        color: white;
        padding: 0.75rem 1rem;
    }

    .form-section {
        background-color: white;
        border-radius: 0.5rem;
        padding: 1rem;
        margin-bottom: 1rem;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }

    .form-section-title {
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: #495057;
        border-bottom: 1px solid #dee2e6;
        padding-bottom: 0.5rem;
    }

    .action-card {
        transition: transform 0.2s, box-shadow 0.2s;
        border: none;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }

    .action-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
    }

    .action-card .card-header {
        font-weight: 600;
        border-bottom: none;
    }

    .action-card .card-body {
        padding: 1.25rem;
    }

    .action-icon {
        font-size: 1.5rem;
        margin-right: 0.5rem;
    }

    .table-container {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        overflow: hidden;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        margin-top: 1rem;
    }

    .table-header {
        background-color: #343a40;
        color: white;
    }

    .dataTables_wrapper {
        padding: 1rem;
    }

    @@media (max-width: 768px) {
        .action-card .card-body {
            padding: 1rem;
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
        }
    }
</style>

<div class="container-fluid px-0">
    <div class="card mb-3">
        <div class="card-header card-header-custom p-2">
            <div class="d-flex align-items-center">
                <a asp-action="Index" class="btn btn-link text-white p-0 me-2">
                    <i class="fas fa-arrow-left fa-lg"></i>
                </a>
                <h5 class="mb-0 text-white flex-grow-1 text-center">Credit & Debit Records</h5>
            </div>
        </div>
        <div class="card-body p-0">
            <div class="form-section">
                <div class="form-section-title">
                    <i class="fas fa-list action-icon"></i>Transaction History
                </div>
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped mb-0" id="recordsTable">
                            <thead class="table-header">
                                <tr>
                                    <th>Date</th>
                                    <th>Customer</th>
                                    <th>Segment</th>
                                    <th>Crate Type</th>
                                    <th>Reason</th>
                                    <th>Created By</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var record in Model)
                                {
                                    <tr>
                                        <td>@record.Date.ToString("yyyy-MM-dd")</td>
                                        <td>@(record.Customer?.Name ?? "N/A")</td>
                                        <td>@record.Segment</td>
                                        <td>@(record.CratesType?.Cratestype ?? "N/A")</td>
                                        <td>@record.Reason</td>
                                        <td>@record.CreatedBy</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Initialize dataTable with specific options only if not already initialized
            if (!$.fn.DataTable.isDataTable("#recordsTable")) {
                $('#recordsTable').DataTable({
                    "order": [[0, "desc"]], // Sort by date descending by default
                    "pageLength": 25,
                    "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                    "responsive": true,
                    "paging": true,
                    "pagingType": "full_numbers",
                    "language": {
                        "paginate": {
                            "first": "First",
                            "last": "Last",
                            "next": "Next",
                            "previous": "Previous"
                        },
                        "lengthMenu": "Show _MENU_ entries per page",
                        "info": "Showing _START_ to _END_ of _TOTAL_ entries",
                        "search": "Search:"
                    }
                });
            }
        });
    </script>
}